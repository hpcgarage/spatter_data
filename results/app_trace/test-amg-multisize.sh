#!/bin/bash

#time is in seconds
echo "# generated by amg-sizes.txt"
echo "time size PAPI_L1_TCM PAPI_L1_TCM PAPI_L1_TCM PAPI_TLB_DM"
for s in 36 40 44 48 52 56 60;
do
	for i in `seq 1 10`;
	do
		cp papi_01.txt papi_config.txt 
		a=`OMP_NUM_THREADS=12 likwid-pin -c N:0-23 ./amg -problem 1 -n $s $s $s | grep PROFILE | cut -d' ' -f2,3,4`
		cp papi_23.txt papi_config.txt 
		b=`OMP_NUM_THREADS=12 likwid-pin -c N:0-23 ./amg -problem 1 -n $s $s $s | grep PROFILE | cut -d' ' -f3,4`

		echo $s $a $b
	done;
done;
